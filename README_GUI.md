# Web Form Automation System - GUI版

グラフィカルユーザーインターフェース（GUI）を使った簡単操作のWebフォーム自動化システムです。

## 🎯 主な機能

### 📱 ユーザーフレンドリーなインターフェース
- **ファイル選択**: ドラッグ&ドロップまたはブラウザでCSVファイル選択
- **設定パネル**: ブラウザ、タイムアウト、ログレベル等の設定
- **リアルタイムログ**: 処理状況をリアルタイムで確認
- **データプレビュー**: CSVデータの内容を事前確認
- **進捗表示**: 処理状況をプログレスバーで表示

### 🎛️ 操作パネル
- **開始/停止ボタン**: ワンクリックで自動化を開始・停止
- **スクリーンショット機能**: デバッグ用のスクリーンショット撮影
- **ログ管理**: ログの表示、保存、クリア機能

## 📦 インストール & 起動

### 方法1: ランチャースクリプト使用（推奨）
```bash
python3 gui_launcher.py
```
- 依存関係の自動チェック・インストール
- 不足パッケージがあれば自動で提案

### 方法2: 直接起動
```bash
# 依存関係のインストール
pip install -r requirements.txt

# GUI起動
python3 gui_automation.py
```

## 🎮 使用方法

### 1. アプリケーション起動
```bash
python3 gui_launcher.py
```

### 2. CSVファイルの選択
- **メインタブ** → **Browse**ボタンをクリック
- CSVファイルを選択
- 自動でデータプレビューが表示

### 3. 設定の調整（オプション）
- **設定タブ**に移動
- ブラウザの種類（Chrome/Firefox/Edge）を選択
- ヘッドレスモード（ブラウザ画面を表示しない）の設定
- タイムアウト時間の調整
- ログレベルの設定

### 4. 自動化の実行
- **メインタブ** → **Start Automation**ボタンをクリック
- 処理状況はログタブでリアルタイム確認
- 進捗はプログレスバーで表示

### 5. 結果の確認
- **ログタブ**で詳細な実行ログを確認
- エラーが発生した場合はスクリーンショット機能で状況確認

## 🎨 画面構成

### メインタブ
```
┌─────────────────────────────────────────┐
│ CSV File Selection                      │
│ [CSV File: ____________] [Browse]       │
├─────────────────────────────────────────┤
│ Target URL (Optional)                   │
│ [URL: _________________________]       │
├─────────────────────────────────────────┤
│ Data Preview                            │
│ ┌─────────────────────────────────────┐ │
│ │ Total Sets: 15                      │ │
│ │ Games per Set: 13                   │ │
│ │ Set 1: 1,2,1,2,1,2,2,1,2,2,0,0,0   │ │
│ │ Set 2: 2,0,2,1,1,1,1,1,0,2,2,1,0   │ │
│ └─────────────────────────────────────┘ │
│ [Load & Preview Data]                   │
├─────────────────────────────────────────┤
│ [Start Automation] [Stop] [Screenshot]  │
└─────────────────────────────────────────┘
```

### 設定タブ
```
┌─────────────────────────────────────────┐
│ Browser Settings                        │
│ Browser: [Chrome ▼] ☑ Headless Mode    │
├─────────────────────────────────────────┤
│ Timeout Settings                        │
│ WebDriver Timeout: [10] seconds         │
├─────────────────────────────────────────┤
│ Logging Settings                        │
│ Log Level: [INFO ▼]                     │
├─────────────────────────────────────────┤
│ Processing Settings                     │
│ Sets per Batch: [10]                    │
│                                         │
│ [Apply Settings]                        │
└─────────────────────────────────────────┘
```

### ログタブ
```
┌─────────────────────────────────────────┐
│ ┌─────────────────────────────────────┐ │
│ │ 2024-01-01 12:00:01 - INFO - Ready │ │
│ │ 2024-01-01 12:00:02 - INFO - CSV   │ │
│ │ loaded: 15 sets                     │ │
│ │ 2024-01-01 12:00:03 - INFO - Start │ │
│ │ automation...                       │ │
│ └─────────────────────────────────────┘ │
│ [Clear Logs] [Save Logs]    ☑ Auto Scroll│
└─────────────────────────────────────────┘
```

## ⚙️ 設定項目詳細

### ブラウザ設定
- **Chrome**: 推奨ブラウザ（安定性が高い）
- **Firefox**: 代替オプション
- **Edge**: Windows環境での代替
- **ヘッドレスモード**: ブラウザ画面を表示せずに実行

### タイムアウト設定
- **5-60秒**: 要素の検索待機時間
- **推奨値**: 10-15秒

### ログレベル
- **DEBUG**: 詳細な動作ログ（開発・デバッグ用）
- **INFO**: 一般的な動作ログ（推奨）
- **WARNING**: 警告以上のみ
- **ERROR**: エラーのみ

### 処理設定
- **Sets per Batch**: 一度に処理するセット数（1-20）
- **推奨値**: 10セット

## 🔧 トラブルシューティング

### よくある問題

**1. 「依存関係が不足しています」**
```bash
# ランチャーでの自動インストールを試す
python3 gui_launcher.py

# または手動インストール
pip install -r requirements.txt
```

**2. 「WebDriverが見つかりません」**
- 設定タブでブラウザを変更してみる
- インターネット接続を確認（WebDriverの自動ダウンロードが必要）

**3. 「要素が見つかりません」**
- スクリーンショット機能で現在の画面を確認
- ログレベルをDEBUGに変更して詳細確認
- タイムアウト時間を延長

**4. 「CSVファイルの読み込みエラー」**
- ファイル形式を確認（カンマ区切り、13列、値は0/1/2のみ）
- ファイルエンコーディングを確認（UTF-8推奨）

### デバッグ機能

**スクリーンショット撮影**
- 処理中の画面状況を確認
- エラー発生時の状況把握

**詳細ログ出力**
- DEBUG レベルで要素検索の詳細を確認
- ログの保存機能で後から分析

## 📂 ファイル構成（GUI版）

```
├── gui_automation.py      # GUI アプリケーション本体
├── gui_launcher.py        # 起動用ランチャー
├── voting_automation.py   # 自動化エンジン
├── config.py              # 設定管理
├── data_handler.py        # CSV データ処理
├── web_driver_manager.py  # WebDriver 管理
├── form_filler.py         # フォーム操作
├── requirements.txt       # 依存関係
├── sample_data.csv        # サンプルデータ
├── README.md              # CLI版 README
└── README_GUI.md          # GUI版 README（本ファイル）
```

## 🚀 実行例

### 基本的な使用流れ
1. **ランチャー実行**: `python3 gui_launcher.py`
2. **CSVファイル選択**: Browseボタンでファイル選択
3. **データ確認**: プレビューでデータ内容確認
4. **設定調整**: 必要に応じて設定タブで調整
5. **実行開始**: Start Automationボタンクリック
6. **結果確認**: ログタブで実行状況確認

### 推奨設定
- **ブラウザ**: Chrome
- **ヘッドレス**: 開発時はOFF、本番はON
- **タイムアウト**: 15秒
- **ログレベル**: INFO
- **バッチサイズ**: 10セット

## 🔒 セキュリティ注意事項

- 許可されたWebサイトでのみ使用
- 利用規約の確認
- 適切な間隔での実行
- 個人情報の取り扱い注意

## 💡 Tips

**効率的な使用方法**
1. 小さなデータセットでテスト実行
2. スクリーンショット機能でサイト構造確認
3. ログレベルDEBUGでの詳細確認
4. 設定の保存と再利用

**パフォーマンス最適化**
- ヘッドレスモードの活用
- 適切なバッチサイズの設定
- タイムアウト時間の調整

このGUI版により、技術的な知識がなくても直感的に自動化システムを利用できます！